#include <ultra64.h>
#include "sm64.h"
#include "behavior_data.h"
#include "model_ids.h"
#include "seq_ids.h"
#include "dialog_ids.h"
#include "segment_symbols.h"
#include "level_commands.h"

#include "game/level_update.h"

#include "levels/scripts.h"

#include "actors/common1.h"
#include "make_const_nonconst.h"
#include "levels/sl/header.h"

/* Fast64 begin persistent block [scripts] */
#include "levels/sl/custom_c/custom.collision.inc.c"
#define sl_area_1_collision col_sl_1_0xe02ec20

extern const BehaviorScript bhvStarRoadShyguy[];
#define bhvKlepto bhvStarRoadShyguy

extern const GeoLayout Geo_sl_1_0x1741700[];
#define sl_area_1 Geo_sl_1_0x1741700

extern const GeoLayout shyguy_geo[];
/* Fast64 end persistent block [scripts] */

const LevelScript level_sl_entry[] = {
	INIT_LEVEL(),
	LOAD_MIO0(0x07, _sl_segment_7SegmentRomStart, _sl_segment_7SegmentRomEnd), 
	LOAD_VANILLA_OBJECTS(0, sl, snow),
	LOAD_MIO0(        /*seg*/ 0x0B, _effect_mio0SegmentRomStart, _effect_mio0SegmentRomEnd),
	LOAD_MIO0(0xA,_ccm_skybox_mio0SegmentRomStart,_ccm_skybox_mio0SegmentRomEnd),
	LOAD_MIO0(8,_common0_mio0SegmentRomStart,_common0_mio0SegmentRomEnd),
	LOAD_RAW(15,_common0_geoSegmentRomStart,_common0_geoSegmentRomEnd),
	LOAD_MIO0(5,_group7_mio0SegmentRomStart,_group7_mio0SegmentRomEnd),
	LOAD_RAW(12,_group7_geoSegmentRomStart,_group7_geoSegmentRomEnd),
	LOAD_MIO0(6,_group16_mio0SegmentRomStart,_group16_mio0SegmentRomEnd),
	LOAD_RAW(13,_group16_geoSegmentRomStart,_group16_geoSegmentRomEnd),
	ALLOC_LEVEL_POOL(),
	MARIO(MODEL_MARIO, 0x00000001, bhvMario), 
	JUMP_LINK(script_func_vo_sl),
	LOAD_MODEL_FROM_GEO(18, snow_tree_geo),
	LOAD_MODEL_FROM_GEO(22, warp_pipe_geo),
	LOAD_MODEL_FROM_GEO(23, bubbly_tree_geo),
	LOAD_MODEL_FROM_GEO(24, spiky_tree_geo),
	LOAD_MODEL_FROM_GEO(25, snow_tree_geo),
	LOAD_MODEL_FROM_GEO(31, metal_door_geo),
	LOAD_MODEL_FROM_GEO(32, shyguy_geo),
	LOAD_MODEL_FROM_GEO(34, castle_door_0_star_geo),
	LOAD_MODEL_FROM_GEO(35, castle_door_1_star_geo),
	LOAD_MODEL_FROM_GEO(36, castle_door_3_stars_geo),
	LOAD_MODEL_FROM_GEO(37, key_door_geo),
	LOAD_MODEL_FROM_GEO(38, castle_door_geo),
	// LOAD_MODEL_FROM_GEO(100,0x06003754),
	// LOAD_MODEL_FROM_GEO(101,0x06003874),
	// LOAD_MODEL_FROM_DL(132,0x08025f08,4),
	// LOAD_MODEL_FROM_DL(158,0x0302c8a0,4),
	// LOAD_MODEL_FROM_DL(159,0x0302bcd0,4),
	// LOAD_MODEL_FROM_DL(161,0x0301cb00,4),
	// LOAD_MODEL_FROM_DL(164,0x04032a18,4),
	// LOAD_MODEL_FROM_DL(201,0x080048e0,4),
	// LOAD_MODEL_FROM_DL(218,0x08024bb8,4),
	JUMP_LINK(script_func_global_1),
	JUMP_LINK(script_func_global_8),
	JUMP_LINK(script_func_global_17),
	/* Fast64 begin persistent block [level commands] */
	/* Fast64 end persistent block [level commands] */

	AREA(1, sl_area_1),
		TERRAIN(sl_area_1_collision),
		MACRO_OBJECTS(sl_area_1_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, SEQ_LEVEL_GRASS),
		TERRAIN_TYPE(TERRAIN_GRASS),
		/* Fast64 begin persistent block [area commands] */
		SET_BACKGROUND_MUSIC(0,8),
		TERRAIN_TYPE(2),

		OBJECT_WITH_ACTS(0,-4801,2338,-2410,0,90,0,0xa0000, bhvSpinAirborneWarp,31),
		OBJECT_WITH_ACTS(101,4481,3752,3339,0,0,0,0x0, bhvBigChillBully,1),
		OBJECT_WITH_ACTS(100,-1258,1150,-4642,0,-153,0,0x0, bhvSmallChillBully,63),
		OBJECT_WITH_ACTS(18,-1176,1204,725,0,107,0,0x0, bhvTree,63),
		OBJECT_WITH_ACTS(116,4301,3725,3787,0,-151,0,0xe0000, bhvMoneybagHidden,62),
		OBJECT_WITH_ACTS(18,-3742,1204,-2823,0,0,0,0x0, bhvTree,63),
		OBJECT_WITH_ACTS(0,4516,3725,3300,90,0,0,0x20000, bhvCoinFormation,62),
		OBJECT_WITH_ACTS_FORCE_ACTIVE(87,5503,2275,-5422,0,0,0,0x3000000, bhvTuxiesMother,62),
		OBJECT_WITH_ACTS_FORCE_ACTIVE(87,-6375,856,-487,0,0,0,0x0, bhvSmallPenguin,62),
		OBJECT_WITH_ACTS(137,-4788,4141,2981,0,0,0,0x30000, bhvExclamationBox,63),
		OBJECT_WITH_ACTS(122,3329,2266,3368,0,0,0,0x2000000, bhvStar,63),
		OBJECT_WITH_ACTS(84,4116,2703,-5704,0,0,0,0x0, bhvSpindrift,255),
		OBJECT_WITH_ACTS(122,6499,2089,-6419,0,0,0,0x5000000, bhvStar,63),
		OBJECT_WITH_ACTS(18,4800,1832,-3487,0,0,0,0x0, bhvTree,63),
		OBJECT_WITH_ACTS(137,-3275,2501,3340,0,0,0,0x10a0000, bhvExclamationBox,63),
		OBJECT_WITH_ACTS(0,-4675,2133,783,0,0,0,0x4000000, bhvHiddenRedCoinStar,63),
		OBJECT_WITH_ACTS(18,-6403,1832,1126,0,0,0,0x0, bhvTree,63),
		OBJECT_WITH_ACTS(215,1539,2437,-5090,0,0,0,0x0, bhvRedCoin,63),
		OBJECT_WITH_ACTS(18,-6520,868,-171,0,0,0,0x0, bhvTree,63),
		OBJECT_WITH_ACTS(100,4507,3725,3336,0,0,0,0x0, bhvSmallChillBully,62),
		OBJECT_WITH_ACTS(100,-5027,3858,2858,0,0,0,0x0, bhvSmallChillBully,63),
		OBJECT_WITH_ACTS(85,-3221,-617,2533,0,0,0,0x0, bhvMrBlizzard,63),
		OBJECT_WITH_ACTS(86,-3420,135,1116,0,27,0,0x10000, bhvMrBlizzard,63),
		OBJECT_WITH_ACTS(85,-2980,235,4100,0,0,0,0x0, bhvMrBlizzard,63),
		OBJECT_WITH_ACTS(86,-3079,-132,3388,0,0,0,0x10000, bhvMrBlizzard,63),
		OBJECT_WITH_ACTS(85,-3810,790,125,0,0,0,0x0, bhvMrBlizzard,63),
		OBJECT_WITH_ACTS(0,-2481,3842,3453,0,90,0,0x0, bhvBouncingFireball,63),
		OBJECT_WITH_ACTS(0,-925,2815,3630,0,271,0,0x0, bhvBouncingFireball,63),
		OBJECT_WITH_ACTS(0,1086,1872,2822,337,0,0,0x0, bhvFlamethrower,63),
		OBJECT_WITH_ACTS(0,1631,1872,4176,339,180,0,0x0, bhvFlamethrower,63),
		OBJECT_WITH_ACTS(84,3545,1676,-4432,0,0,0,0x0, bhvSpindrift,63),
		OBJECT_WITH_ACTS(215,4798,2611,1127,0,0,0,0x0, bhvRedCoin,63),
		OBJECT_WITH_ACTS(215,2531,-54,840,0,0,0,0x0, bhvRedCoin,63),
		OBJECT_WITH_ACTS(215,-6688,1231,660,0,0,0,0x0, bhvRedCoin,63),
		OBJECT_WITH_ACTS(215,404,443,529,0,0,0,0x0, bhvRedCoin,63),
		OBJECT_WITH_ACTS(215,-805,-97,3003,0,0,0,0x0, bhvRedCoin,63),
		OBJECT_WITH_ACTS(215,-5432,2161,-3103,0,0,0,0x0, bhvRedCoin,63),
		OBJECT_WITH_ACTS(215,3507,1707,-4656,0,0,0,0x0, bhvRedCoin,63),
		OBJECT_WITH_ACTS(0,3126,772,596,0,0,0,0x0, bhvCoinFormation,127),
		OBJECT_WITH_ACTS(0,3413,1675,564,0,0,0,0x0, bhvCoinFormation,63),
		OBJECT_WITH_ACTS(0,2028,181,280,0,0,0,0x110000, bhvCoinFormation,63),
		OBJECT_WITH_ACTS(129,-5670,2249,1249,0,0,0,0x0, bhvJumpingBox,63),
		OBJECT_WITH_ACTS(84,-1041,1192,-151,0,0,0,0x0, bhvSpindrift,63),
		OBJECT_WITH_ACTS(18,6293,2289,-2306,0,0,0,0x0, bhvTree,63),
		OBJECT_WITH_ACTS(129,3427,938,1656,0,0,0,0x10000, bhvBreakableBox,63),
		OBJECT_WITH_ACTS(0,-1255,1162,-4674,0,0,0,0x20000, bhvCoinFormation,63),
		OBJECT_WITH_ACTS(220,1899,1812,-3786,0,0,0,0x0, bhvFlyGuy,63),
		OBJECT_WITH_ACTS(220,-1457,1416,-2746,0,0,0,0x10000, bhvFlyGuy,63),
		OBJECT_WITH_ACTS(32,-4962,1820,325,0,0,0,0x0, bhvKlepto,63),
		OBJECT_WITH_ACTS(32,-5472,1820,374,0,0,0,0x0, bhvKlepto,63),
		OBJECT_WITH_ACTS(32,4731,1820,-2190,0,0,0,0x0, bhvKlepto,63),
		OBJECT_WITH_ACTS(32,3968,1776,-1818,0,0,0,0x0, bhvKlepto,63),
		OBJECT_WITH_ACTS(140,-650,1162,-5254,0,0,0,0x0, bhvBlueCoinSwitch,63),
		OBJECT_WITH_ACTS(118,-660,1162,-4842,0,0,0,0x0, bhvHiddenBlueCoin,63),
		OBJECT_WITH_ACTS(18,3367,1747,-1397,0,0,0,0x0, bhvTree,63),
		OBJECT_WITH_ACTS(118,407,1162,-4837,0,0,0,0x0, bhvHiddenBlueCoin,63),
		OBJECT_WITH_ACTS(118,953,1511,-4490,0,0,0,0x0, bhvHiddenBlueCoin,63),
		OBJECT_WITH_ACTS(118,1528,1511,-4468,0,0,0,0x0, bhvHiddenBlueCoin,63),
		OBJECT_WITH_ACTS(118,1564,1511,-3792,0,0,0,0x0, bhvHiddenBlueCoin,63),
		OBJECT_WITH_ACTS(118,2346,1511,-3781,0,0,0,0x0, bhvHiddenBlueCoin,63),
		OBJECT_WITH_ACTS(212,4730,5100,3681,0,0,0,0x0, bhv1Up,63),
		OBJECT_WITH_ACTS(217,1554,1511,-4129,0,0,0,0x0, bhvPushableMetalBox,63),
		OBJECT_WITH_ACTS(85,6250,2277,-1873,0,0,0,0x0, bhvMrBlizzard,63),
		OBJECT_WITH_ACTS(0,5891,2329,-617,0,336,0,0x0, bhvCoinFormation,63),
		OBJECT_WITH_ACTS(85,-221,1192,-434,0,0,0,0x0, bhvMrBlizzard,63),
		OBJECT_WITH_ACTS(0,-5435,2148,-4052,0,0,0,0x0, bhvCoinFormation,127),
		OBJECT_WITH_ACTS(124,-3259,1204,-1865,0,241,0,0x9d0000, bhvMessagePanel,63),
		OBJECT_WITH_ACTS(220,4716,2849,2349,0,0,0,0x0, bhvFlyGuy,63),
		OBJECT_WITH_ACTS(32,3016,-59,-226,0,0,0,0x0, bhvKlepto,63),
		OBJECT_WITH_ACTS(220,-60,1351,538,0,0,0,0x10000, bhvFlyGuy,63),
		OBJECT_WITH_ACTS(32,-5963,1192,-2251,0,0,0,0x0, bhvKlepto,63),
		OBJECT_WITH_ACTS(86,-5560,1833,5306,0,77,0,0x10000, bhvMrBlizzard,63),
		OBJECT_WITH_ACTS(86,-4031,1016,5203,0,0,0,0x0, bhvMrBlizzard,63),
		OBJECT_WITH_ACTS(0,3631,3098,-5564,0,136,0,0x40000, bhvCoinFormation,63),
		OBJECT_WITH_ACTS(0,-1644,2285,3778,0,0,0,0x0, bhvSnowMoundSpawn,63),
		OBJECT_WITH_ACTS(86,-4963,2286,3778,0,90,0,0x10000, bhvMrBlizzard,63),
		OBJECT_WITH_ACTS(0,-4856,2340,-6446,0,0,0,0x0, bhvHidden1upTrigger,63),
		OBJECT_WITH_ACTS(0,-5450,2540,-6441,0,0,0,0x0, bhvHidden1upTrigger,63),
		OBJECT_WITH_ACTS(0,-5452,2740,-5847,0,0,0,0x0, bhvHidden1upTrigger,63),
		OBJECT_WITH_ACTS(0,-6058,2940,-5848,0,0,0,0x0, bhvHidden1upTrigger,63),
		OBJECT_WITH_ACTS(212,-6058,2940,-5848,0,0,0,0x40000, bhvHidden1up,63),
		OBJECT_WITH_ACTS(0,-1315,2285,3778,0,0,0,0x0, bhvSnowMoundSpawn,63),
		OBJECT_WITH_ACTS(18,-5175,2238,-6850,0,0,0,0x0, bhvTree,63),
		OBJECT_WITH_ACTS(18,-6557,2244,-5531,0,0,0,0x0, bhvTree,63),
		OBJECT_WITH_ACTS(18,-4441,1201,-3581,0,0,0,0x0, bhvTree,63),
		OBJECT_WITH_ACTS(18,-6350,1201,-2389,0,0,0,0x0, bhvTree,63),
		OBJECT_WITH_ACTS(18,-4458,1207,-895,0,0,0,0x0, bhvTree,63),
		OBJECT_WITH_ACTS(32,-4508,2238,-6831,0,0,0,0x0, bhvKlepto,63),
		OBJECT_WITH_ACTS(84,-5686,2238,-5383,0,0,0,0x0, bhvSpindrift,63),
		OBJECT_WITH_ACTS(116,-3670,1403,-6231,0,0,0,0x0, bhvOneCoin,63),
		OBJECT_WITH_ACTS(116,-4169,1824,-5851,0,0,0,0x0, bhvOneCoin,63),
		OBJECT_WITH_ACTS(137,-6884,2521,-5775,0,0,0,0x60000, bhvExclamationBox,63),
		OBJECT_WITH_ACTS(124,-5919,1830,835,0,180,0,0x1e0000, bhvMessagePanel,127),
		OBJECT_WITH_ACTS(129,-1801,1159,-6504,0,0,0,0x10000, bhvBreakableBox,63),
		OBJECT_WITH_ACTS_FORCE_ACTIVE(0,-982,2292,3778,0,0,0,0x0, bhvSnowMoundSpawn,95),
		OBJECT_WITH_ACTS(0,-666,2292,3778,0,0,0,0x0, bhvSnowMoundSpawn,159),
		OBJECT_WITH_ACTS(0,-349,2292,3778,0,0,0,0x0, bhvSnowMoundSpawn,159),
		OBJECT_WITH_ACTS(0,-110,-625,4289,0,204,0,0x50000, bhvFadingWarp,63),
		OBJECT_WITH_ACTS(0,-4074,2377,-6695,0,0,0,0x60000, bhvFadingWarp,63),
		OBJECT_WITH_ACTS(212,-1257,320,-5264,0,0,0,0x0, bhv1Up,63),
		OBJECT_WITH_ACTS(18,-805,-609,3003,0,0,0,0x0, bhvTree,63),
		OBJECT_WITH_ACTS(18,-1457,-609,2198,0,0,0,0x0, bhvTree,63),
		OBJECT_WITH_ACTS(116,-1175,-609,2591,0,0,0,0x0, bhvMoneybagHidden,63),
		OBJECT_WITH_ACTS(85,-752,-684,3750,0,0,0,0x0, bhvMrBlizzard,63),
		OBJECT_WITH_ACTS(0,3025,1586,-5441,0,0,0,0x0, bhvCoinFormation,63),
		OBJECT_WITH_ACTS(MODEL_RED_COIN_RADAR,0,0,0,0,0,0,5<<24, bhvRedCoinRadar, 31),

		WARP_NODE(10,9,1,10,0),
		WARP_NODE(11,9,1,12,0),
		WARP_NODE(12,9,1,11,0),
		WARP_NODE(13,9,1,14,0),
		WARP_NODE(14,9,1,13,0),
		WARP_NODE(240,26,1,12,0),
		WARP_NODE(241,26,1,13,0),
		WARP_NODE(0,10,1,1,0),
		WARP_NODE(1,10,1,0,0),
		WARP_NODE(2,9,1,10,0),
		WARP_NODE(3,9,1,10,0),
		WARP_NODE(4,9,1,10,0),
		WARP_NODE(5,10,1,6,0),
		WARP_NODE(6,10,1,5,0),
		/* Fast64 end persistent block [area commands] */
	END_AREA(),
	FREE_LEVEL_POOL(),
	MARIO_POS(1, 0, 0, 0, 0),
	CALL(0, lvl_init_or_update),
	CALL_LOOP(1, lvl_init_or_update),
	CLEAR_LEVEL(),
	SLEEP_BEFORE_EXIT(1),
	EXIT(),
};